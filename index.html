<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Conformista by avdgaag</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Conformista</h1>
        <p class="header">Library for creating form objects for Rails applications.</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/avdgaag/conformista/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/avdgaag/conformista/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/avdgaag/conformista">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/avdgaag">avdgaag</a></p>


      </header>
      <section>
        <h1>
<a name="conformista-" class="anchor" href="#conformista-"><span class="octicon octicon-link"></span></a>Conformista <a href="http://travis-ci.org/avdgaag/conformista"><img src="https://secure.travis-ci.org/avdgaag/conformista.png?branch=master" alt="Build Status"></a>
</h1>

<h2>
<a name="introduction" class="anchor" href="#introduction"><span class="octicon octicon-link"></span></a>Introduction</h2>

<p>Conformista is a library to make building presenters -- and form objects in
particular -- easier. It provides an ActiveModel-compliant base class that your
own form objects can inherit from, along with standard behaviour for creating,
loading, validating and persisting business objects (usually ActiveRecord
models).</p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>Conformista is distributed as a Ruby gem, which should be installed on most Macs and
Linux systems. Once you have ensured you have a working installation of Ruby
and Ruby gems, install the gem as follows from the command line:</p>

<pre><code>$ gem install conformista
</code></pre>

<p>To use it with Bundler, add it to your <code>Gemfile</code>:</p>

<pre><code>gem 'conformista'
</code></pre>

<p>Then install it by running <code>bundle install</code>.</p>

<h2>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>The canonical example of a form object is a sign up form. Let's say we want to
let a visitor to our Rails application sign up for an account. That will include
creating an <code>Account</code>, <code>User</code> and <code>Profile</code>.</p>

<div class="highlight highlight-ruby"><pre><span class="k">class</span> <span class="nc">Account</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
  <span class="n">validates</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">presence</span><span class="p">:</span> <span class="kp">true</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
  <span class="n">validates</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">:password</span><span class="p">,</span> <span class="ss">presence</span><span class="p">:</span> <span class="kp">true</span>
  <span class="n">has_secure_password</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Profile</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
<span class="k">end</span>
</pre></div>

<p>Instead of using <code>accepts_nested_attributes_for</code>, or cramming all the data in
the <code>User</code> model, or using a lot of controller logic, we use a form object to
present these three entities as a single object to the view:</p>

<div class="highlight highlight-ruby"><pre><span class="k">class</span> <span class="nc">SignupController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="k">def</span> <span class="nf">new</span>
    <span class="vi">@signup</span> <span class="o">=</span> <span class="no">Signup</span><span class="o">.</span><span class="n">new</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">create</span>
    <span class="vi">@signup</span> <span class="o">=</span> <span class="no">Signup</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:signup</span><span class="o">]</span><span class="p">)</span>
    <span class="k">if</span> <span class="vi">@signup</span><span class="o">.</span><span class="n">save</span>
      <span class="n">redirect_to</span> <span class="n">root_url</span><span class="p">,</span> <span class="ss">notice</span><span class="p">:</span> <span class="s1">'Thanks for signing up!'</span>
    <span class="k">else</span>
      <span class="n">render</span> <span class="s1">'new'</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>

<p>The single object we use is a form object that inherits from
<code>Conformista::FormObject</code>:</p>

<div class="highlight highlight-ruby"><pre><span class="k">class</span> <span class="nc">Signup</span> <span class="o">&lt;</span> <span class="ss">Conformista</span><span class="p">:</span><span class="ss">:FormObject</span>
  <span class="n">presents</span> <span class="no">User</span>    <span class="o">=&gt;</span> <span class="o">%</span><span class="n">i</span><span class="o">[</span><span class="n">email</span> <span class="n">password</span><span class="o">]</span><span class="p">,</span>
           <span class="no">Account</span> <span class="o">=&gt;</span> <span class="o">%</span><span class="n">i</span><span class="o">[</span><span class="nb">name</span><span class="o">]</span><span class="p">,</span>
           <span class="no">Profile</span> <span class="o">=&gt;</span> <span class="o">%</span><span class="n">i</span><span class="o">[</span><span class="n">bio</span> <span class="n">twitter</span> <span class="n">github</span><span class="o">]</span>

  <span class="kp">attr_accessor</span> <span class="ss">:password_confirmation</span><span class="p">,</span>
                <span class="ss">:terms_and_conditions</span>

  <span class="n">validates</span> <span class="ss">:password</span><span class="p">,</span> <span class="ss">confirmation</span><span class="p">:</span> <span class="kp">true</span>
  <span class="n">validates</span> <span class="ss">:terms_and_conditions</span><span class="p">,</span> <span class="ss">acceptance</span><span class="p">:</span> <span class="kp">true</span>

  <span class="n">after_save</span> <span class="ss">:deliver_welcome_email</span>

  <span class="kp">private</span>

  <span class="k">def</span> <span class="nf">deliver_welcome_email</span>
    <span class="no">Notifications</span><span class="o">.</span><span class="n">welcome_email</span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="o">.</span><span class="n">deliver</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>

<p>We can now generate a form for our form object:</p>

<div class="highlight highlight-erb"><pre><span class="cp">&lt;%=</span> <span class="n">form_for</span> <span class="vi">@signup</span><span class="p">,</span> <span class="ss">url</span><span class="p">:</span> <span class="n">signup_path</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="cp">%&gt;</span><span class="x"></span>
<span class="x">  &lt;p&gt;</span>
<span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:name</span> <span class="cp">%&gt;</span><span class="x">&lt;br&gt;</span>
<span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_field</span> <span class="ss">:name</span> <span class="cp">%&gt;</span><span class="x"></span>
<span class="x">  &lt;/p&gt;</span>
<span class="x">  &lt;p&gt;</span>
<span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:email</span> <span class="cp">%&gt;</span><span class="x">&lt;br&gt;</span>
<span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_field</span> <span class="ss">:email</span> <span class="cp">%&gt;</span><span class="x"></span>
<span class="x">  &lt;/p&gt;</span>
<span class="x">  &lt;p&gt;</span>
<span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:password</span> <span class="cp">%&gt;</span><span class="x"></span>
<span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">password_field</span> <span class="ss">:password</span> <span class="cp">%&gt;</span><span class="x"></span>
<span class="x">  &lt;/p&gt;</span>
<span class="x">  &lt;p&gt;</span>
<span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:password_confirmation</span> <span class="cp">%&gt;</span><span class="x">&lt;br&gt;</span>
<span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">password_field</span> <span class="ss">:password_confirmation</span> <span class="cp">%&gt;</span><span class="x"></span>
<span class="x">  &lt;/p&gt;</span>
<span class="x">  &lt;p&gt;</span>
<span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:bio</span> <span class="cp">%&gt;</span><span class="x">&lt;br&gt;</span>
<span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_area</span> <span class="ss">:bio</span> <span class="cp">%&gt;</span><span class="x">&lt;br&gt;</span>
<span class="x">  &lt;/p&gt;</span>
<span class="x">  &lt;p&gt;</span>
<span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:twitter</span> <span class="cp">%&gt;</span><span class="x">&lt;br&gt;</span>
<span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_field</span> <span class="ss">:twitter</span> <span class="cp">%&gt;</span><span class="x">&lt;br&gt;</span>
<span class="x">  &lt;/p&gt;</span>
<span class="x">  &lt;p&gt;</span>
<span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:github</span> <span class="cp">%&gt;</span><span class="x">&lt;br&gt;</span>
<span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_field</span> <span class="ss">:github</span> <span class="cp">%&gt;</span><span class="x">&lt;br&gt;</span>
<span class="x">  &lt;/p&gt;</span>
<span class="x">  &lt;p&gt;</span>
<span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">check_box</span> <span class="ss">:terms_and_conditions</span> <span class="cp">%&gt;</span><span class="x"></span>
<span class="x">    I have read and agree to the terms and conditions</span>
<span class="x">  &lt;/p&gt;</span>
<span class="x">  &lt;p&gt;</span>
<span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">submit</span> <span class="cp">%&gt;</span><span class="x"></span>
<span class="x">  &lt;/p&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span><span class="x"></span>
</pre></div>

<p>Note how the logic specifically tied to the form, like the acceptance and
confirmation validations, and the email delivery, have been moved out of the
model layer into the presenter layer. However, the single presenter object
will re-use the data-specific validations defined in the model.</p>

<h3>
<a name="documentation" class="anchor" href="#documentation"><span class="octicon octicon-link"></span></a>Documentation</h3>

<p>See the inline <a href="http://rubydoc.info/github/avdgaag/conformista/master/frames">API
docs</a> for more
information.</p>

<h2>
<a name="other" class="anchor" href="#other"><span class="octicon octicon-link"></span></a>Other</h2>

<h3>
<a name="note-on-patchespull-requests" class="anchor" href="#note-on-patchespull-requests"><span class="octicon octicon-link"></span></a>Note on Patches/Pull Requests</h3>

<ol>
<li>Fork the project.</li>
<li>Make your feature addition or bug fix.</li>
<li>Add tests for it. This is important so I don't break it in a future version
unintentionally.</li>
<li>Commit, do not mess with rakefile, version, or history. (if you want to have
your own version, that is fine but bump version in a commit by itself I can
ignore when I pull)</li>
<li>Send me a pull request. Bonus points for topic branches.</li>
</ol><h3>
<a name="issues" class="anchor" href="#issues"><span class="octicon octicon-link"></span></a>Issues</h3>

<p>Please report any issues, defects or suggestions in the <a href="https://github.com/avdgaag/conformista/issues">Github issue
tracker</a>.</p>

<h3>
<a name="what-has-changed" class="anchor" href="#what-has-changed"><span class="octicon octicon-link"></span></a>What has changed?</h3>

<p>See the <a href="https://github.com/avdgaag/conformista/blob/master/HISTORY.md">HISTORY</a> file
for a detailed changelog.</p>

<h3>
<a name="credits" class="anchor" href="#credits"><span class="octicon octicon-link"></span></a>Credits</h3>

<p>Created by: Arjan van der Gaag<br>
URL: <a href="http://arjanvandergaag.nl">http://arjanvandergaag.nl</a><br>
Project homepage: <a href="http://avdgaag.github.com/conformista">http://avdgaag.github.com/conformista</a><br>
Date: september 2013<br>
License: <a href="https://github.com/avdgaag/conformista/blob/master/LICENSE">MIT-license</a> (same as Ruby)</p>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		          <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-20357800-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>